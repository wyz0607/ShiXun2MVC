@model IEnumerable<Restaurant_Information_MVC.Models.KitchenViewModel>
@{

    ViewBag.Title = "ShowMenu";
}


<h2>显示菜式信息</h2>
<link href="~/layui/css/layui.css" rel="stylesheet" />
<script src="~/layui-v2.4.5/layui/layui.all.js"></script>
<script src="~/layui-v2.4.5/layui/layui.js"></script>

<p>
    
    <button class="layui-btn" onclick="location.href='/Kitchen/AddMenu'">
        <i class="layui-icon">&#xe608</i>新增菜式
    </button>
    
    <span>总记录数<span id="totaldata">@ViewBag.totaldata</span>条</span>
</p>
<br />
<p>
    <button id="BtnDel" onclick="Dels()" style="float:right;margin-right:150px" type="button"  class="layui-btn layui-btn-radius layui-btn-danger">批量删除</button>
   
    <input type="text" name="title" style="width:200px;float:left;margin-left:70px" required lay-verify="required" placeholder="请输入菜式名称" autocomplete="off" class="layui-input">
    &nbsp;&nbsp;
    <button class="layui-btn layui-btn-small layui-btn-normal">查询</button>
</p>

<div class="container" style="width:1200px;height:580px;margin:0 auto;background-color:#f2f2f2">

    @foreach (var item in Model)
    {
        <table class="col-lg-4" style="width:350px;height:250px;float:left;background-color:#ffffff;margin-left:20px;margin-top:30px;">
            <tr>
                <td colspan="5">
                    <img src="@item.MenuPhoto" style="width:100px;height:100px;" />
                    <div style="margin-left:20px;"> @item.MenuName</div>
                </td>
                <td>
                    <div style="float:right"><input value="@item.MenuID" name="Deles" type="checkbox" /></div>
                    <div> 菜式简介:@item.MenuIntroduce</div>
                    <div>
                        主要食材: @item.MenuIngredients
                    </div>
                    <div>
                        所属菜系:@item.MenuCuisine
                    </div>
                    <div>
                        种类:@item.MenuKind
                    </div>
                    <div>
                        单价:@item.UnitPrice
                    </div>
                    <div>
                        销售量: @item.SalesVolume
                    </div>
                    <br />
                    <div>
                        <button class="layui-btn layui-btn-radius layui-btn-warm" onclick="location.href='/Kitchen/UptMenu?id=@item.MenuID'">菜式修改</button>
                        <button class="layui-btn layui-btn-radius layui-btn-danger" onclick="Del(@item.MenuID,this)">删除菜式</button>
                    </div>

                </td>
            </tr>
        </table>

    }
</div>


<p>
    <span>
        <span>当前第</span>
        <span id="currentindex">@ViewBag.currentindex</span>
        <span>页，总共</span>
        <span id="totalpage"></span>
        <span>页</span>

    </span>
    <button class="layui-btn" onclick="BtnUp()">
        <i class="layui-icon">上一页</i>
    </button>
    <button class="layui-btn" onclick="BtnDown()">
        <i class="layui-icon">下一页</i>
    </button>
</p>
<script>
    function Dels() {
        var MenuIDs = [];
        $("[name='Deles']:checked").each(function () {
            MenuIDs.push($(this).val());
        });
        location.href = "/Kitchen/DelMenu?id=" + MenuIDs;
    }

    $(function () {
        $("#totalpage").text(Math.ceil((Number($("#totaldata").text()) / 6)));
    })
    function BtnUp() {
        if ($("#currentindex").text() != 1) {
            location.href = "/Kitchen/ShowMenu?pageindex=" + Number(Number($("#currentindex").text()) - 1);
        }
        else {
            layui.use('layer', function () {
                layer.alert('已经是首页了');
            })
        }
    }
    function BtnDown() {
        if ($("#currentindex").text() != $("#totalpage").text()) {
            location.href = "/Kitchen/ShowMenu?pageindex=" + Number(Number($("#currentindex").text()) + 1);
        }
        else {
            layui.use('layer', function () {
                layer.alert('已经是尾页了');
            })
        }
    }
</script>

<script>



    fun();
    function fun() {
        $("[name=Menu]").empty();
        $.ajax({
            url: "/Kitchen/ShowMenu",
            contentType: "application/json",
            dataType: "json",
            success: function (data) {
                console.log(data);
                var li = '';
                for (var i in data) {
                    li += '  <li><a href="' + data[i].href + '"><i class="fa fa-edit"></i><span>' + data[i].PermissionName + '</span></a></li>';
                }
                $("[name=Menu]").append(li);
            }
        })
    }
    function Del(id, obj) {

        layui.use('layer', function () {
            layer.confirm('是否删除此菜式?',
                {
                    btn: ['确定', '取消']
                    , yes: function (index, layero) {
                        $.ajax({
                            url: "/Kitchen/DelMenu?id=" + id,
                            success: function (data) {
                                layer.alert(data);
                                location.reload();
                            }
                        })
                    }, btn2: function (index) {
                    }
                })
        })
    }



</script>












@*<html>
    <head>
        <meta name="viewport" content="width=device-width" />
        <title>ShowMenu</title>
        <script src="~/Scripts/jquery-3.3.1.js"></script>
    </head>
    <body>
        <div>
            <div style="width:100%">
                <p>显示菜品列表</p>
                @foreach (var item in Model)
                {
                    <div style="width:450px;height:350px;border:1px solid #ff0000;margin:20px;float:left">
                        <div onclick="Upt(@item.MenuID)" style="width:150px;margin-left:30px;margin-top:50px;float:left;">
                            <img style="width:250px;height:200px;" src="~/Images/Img.PNG" />
                            <span style="margin-left:20px">@item.MenuName</span>
                            <p style="margin:0 auto;width:150px;margin-left:30px;">
                                <input style="background-color:skyblue" type="button" value="修改" onclick="Upt(@item.MenuID)" />
                            </p>
                        </div>

                        <div style="float:left;padding:40px;width:230px;height:300px;">
                            <p>种类:@item.MenuKind</p>
                            <p>所属菜系:@item.MenuCuisine</p>
                            <p>菜式简介:@item.MenuIntroduce</p>
                            <p>主要食材:@item.MenuIngredients</p>
                            <p>单价:@item.UnitPrice</p>
                            <p>销售量：@item.SalesVolume</p>
                        </div>
                        <div style="width:20px;height:20px;float:right;">
                            <input id="Checkbox1" name="Del" type="checkbox" value="@item.MenuID" />
                        </div>
                    </div>
                }
            </div>

            <p>
                <input id="BtnDel" onclick="Del()" type="button" value="批量删除" />
                <span style="margin-left:40%"></span>
                <a href="#" onclick="PageChange('-')">上一页</a>
                <label id="PageIndex">@ViewBag.PageIndex</label>
                <a href="#" onclick="PageChange('+')">下一页</a>
                <select onchange="PageChange('?')" id="PageSize">
                    <option value="3">3条/页</option>
                    <option value="6">6条/页</option>
                    <option value="9">9条/页</option>
                    <option value="12">12条/页</option>
                </select>
            </p>

        </div>
    </body>
    </html>*@
@*<script>
        $(function () {
            $("#PageSize").val(@ViewBag.PageSize);
        })
        function Del() {
            var AIdArr = [];
            $("[name='Del']:checked").each(function () {
                AIdArr.push($(this).val());
            });
            location.href = "/Address/Del/?AID=" + AIdArr + "";
        }
        function Upt(AId) {
            location.href = "/Kitchen/UptView/?AID=" + AId + "&PageIndex=" + $("#PageIndex").text() + "&PageSize=" + $("#PageSize").val() + "";
        }
        function PageChange(By) {
            if (By == '-') {
                $("#PageIndex").text(Number($("#PageIndex").text()) - 1);
            } else if (By == '+') {
                $("#PageIndex").text(Number($("#PageIndex").text()) + 1);
            }
            location.href = "/Kitchen/ShowMenu/?PageIndex=" + $("#PageIndex").text() + "&PageSize=" + $("#PageSize").val() + "";
        }
    </script>*@

